<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Soure ‚Äî Game</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="index-layout">
    <aside class="index-sidebar">
      <div class="brand">
        <h1>Soure</h1>
        <p>Strategy ¬∑ Resources ¬∑ Barbarians</p>
      </div>
      <nav class="index-menu">
        <a class="sidebar-tab active" href="/game">
          <span class="tab-icon">üéÆ</span>
          <span>Game</span>
        </a>
        <a class="sidebar-tab" href="#" onclick="alert('Coming soon'); return false;">
          <span class="tab-icon">üë•</span>
          <span>Friends</span>
        </a>
        <a class="sidebar-tab" href="#" onclick="alert('Coming soon'); return false;">
          <span class="tab-icon">üì¶</span>
          <span>Resources</span>
        </a>
        <a class="sidebar-tab" href="#" onclick="alert('Coming soon'); return false;">
          <span class="tab-icon">‚öôÔ∏è</span>
          <span>Settings</span>
        </a>
      </nav>
      <div style="margin-top: auto; padding-top: 16px; border-top: 1px solid var(--border);">
        <div style="margin-bottom: 8px; font-size: 0.85rem; color: var(--muted);" id="loginStatus">Loading‚Ä¶</div>
        <a href="/login" id="loginLink" class="btn btn-primary hidden" style="width: 100%; margin-bottom: 8px;">Login</a>
        <button type="button" class="btn btn-danger" id="logoutBtn" style="width: 100%;">Logout</button>
      </div>
    </aside>
    <main class="index-main" style="padding: 0;">
      <div class="game-container">
        <header class="game-header">
          <div class="left">
            <a href="/">‚Üê Menu</a>
            <span class="sep">|</span>
            <span id="gameTimer" class="game-timer" style="font-size: 0.9rem; color: var(--muted);">Time: 00:00</span>
          </div>
        </header>

    <!-- Rejoin Banner -->
    <div class="rejoin-banner hidden" id="rejoinBanner">
      <div class="rejoin-content">
        <span class="rejoin-text">‚ö†Ô∏è You were disconnected. Rejoin your current game.</span>
        <button type="button" class="btn btn-primary" id="rejoinBtn">Rejoin Game</button>
      </div>
    </div>

    <section class="game-section" id="lobbySection">
      <h3>Lobby</h3>
      <div class="game-actions">
        <button type="button" class="btn" id="createBtn">Create Game</button>
        <input type="text" class="input" id="joinInput" placeholder="Game ID" />
        <button type="button" class="btn" id="joinBtn">Join Game</button>
      </div>
      <div id="lobbyPlayers" class="lobby-players hidden"></div>
      <div id="lobbyGameId" class="lobby-game-id hidden" style="margin-top: 16px;">
        <p style="margin: 0 0 8px 0; color: var(--muted); font-size: 0.9rem;">Game ID:</p>
        <p style="margin: 0; font-size: 1.2rem; font-weight: 600; color: var(--accent); font-family: monospace;" id="lobbyGameIdText">‚Äî</p>
      </div>
      <div id="lobbyStartBtn" class="hidden" style="margin-top: 16px;">
        <button type="button" class="btn btn-primary" id="startBtnLobby">Start Game</button>
      </div>
    </section>

    <section class="game-section hidden" id="gameInfoSection">
      <div class="game-layout-main">
        <!-- Left: Player List + Stats -->
        <aside class="game-sidebar">
          <h3>Players</h3>
          <div id="playerList" class="player-list-detailed"></div>
        </aside>

        <!-- Center: Board -->
        <div class="game-board-container">
          <div id="hexBoard" class="hex-board"></div>
        </div>

        <!-- Right: Dice + Actions -->
        <aside class="game-actions-panel">
          <div class="dice-panel-inline">
            <div id="diceContainer" class="dice-container-inline">
              <div class="dice-card" id="dice1">?</div>
              <div class="dice-card" id="dice2">?</div>
            </div>
            <div id="diceResult" class="dice-result-inline hidden"></div>
            <div class="game-actions-inline">
              <button type="button" class="btn btn-primary hidden" id="rollBtn">Roll Dice</button>
              <button type="button" class="btn hidden" id="endTurnBtn">End Turn</button>
              <button type="button" class="btn hidden" id="blockTileBtn">Block Tile</button>
            </div>
          </div>
        </aside>
      </div>

      <!-- Breach Phase UI -->
      <div id="breachPanel" class="breach-panel hidden">
        <h3>Breach! Choose a tile to block:</h3>
        <div id="tileSelection" class="tile-selection"></div>
      </div>

      <!-- Building Placement UI -->
      <div id="buildingPanel" class="building-panel hidden">
        <h3>Place Building</h3>
        <div class="building-options">
          <button type="button" class="btn" data-building="outpost">Outpost (1 stone, 1 water) - 1 DP</button>
          <button type="button" class="btn" data-building="bastion">Bastion (1 iron, 1 food) - +1 Defense</button>
        </div>
        <p class="building-hint">Select a building type, then click a tile on the board to place it</p>
        <p class="building-hint" style="font-size: 0.75rem; margin-top: 4px;">Upgrades: Outpost ‚Üí Citadel (2 stone, 2 food) ‚Üí Capital (3 stone, 3 iron, 2 gold)</p>
      </div>
    </section>

    <section class="game-section hidden" id="resourcesSection">
      <h3>Resources</h3>
      <div class="resources-grid" id="resourcesGrid"></div>
    </section>

    <section class="game-section hidden" id="logSection">
      <h3>Event log</h3>
      <div class="event-log" id="eventLog"></div>
    </section>


        <div class="error-msg hidden" id="errorEl" role="alert"></div>
      </div>
    </main>
  </div>

  <!-- Bottom Inventory Bar -->
  <div class="inventory-bar hidden" id="inventoryBar">
    <div class="inventory-content">
      <span class="inventory-label">My Resources:</span>
      <div class="inventory-chips" id="inventoryChips"></div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/game.js"></script>
</body>
</html>
